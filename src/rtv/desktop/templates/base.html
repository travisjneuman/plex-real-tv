<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}RealTV{% endblock %} &mdash; plex-real-tv</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">

    <!-- Local Fonts (offline) -->
    <link rel="stylesheet" href="/static/fonts.css">

    <!-- Tailwind CSS (local runtime) -->
    <script src="/static/vendor/tailwind.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rtv': {
                            'bg':      'var(--rtv-bg)',
                            'surface': 'var(--rtv-surface)',
                            'raised':  'var(--rtv-raised)',
                            'border':  'var(--rtv-border)',
                            'text':    'var(--rtv-text)',
                            'muted':   'var(--rtv-muted)',
                            'accent':  'var(--rtv-accent)',
                            'accent2': 'var(--rtv-accent2)',
                            'success': 'var(--rtv-success)',
                            'warning': 'var(--rtv-warning)',
                            'danger':  'var(--rtv-danger)',
                        }
                    },
                    fontFamily: {
                        'display': ['Dela Gothic One', 'Impact', 'sans-serif'],
                        'body': ['JetBrains Mono', 'Fira Code', 'monospace'],
                    }
                }
            }
        }
    </script>

    <!-- htmx (local) -->
    <script src="/static/vendor/htmx.min.js"></script>
    <script src="/static/vendor/htmx-sse.min.js"></script>

    <!-- Custom CSS (from web static) -->
    <link rel="stylesheet" href="/static/app.css">

    {% block head %}{% endblock %}
</head>
<body class="bg-rtv-bg text-rtv-text font-body min-h-screen">
    <!-- Scanlines overlay -->
    <div class="scanlines" aria-hidden="true"></div>

    <!-- Navigation -->
    <nav class="border-b border-rtv-border bg-rtv-surface/80 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6">
            <div class="flex items-center justify-between h-14">
                <!-- Logo -->
                <a href="/" class="flex items-center gap-3 group">
                    <div class="rtv-logo-icon">
                        <svg viewBox="0 0 28 28" fill="none" class="w-7 h-7">
                            <rect x="2" y="4" width="24" height="18" rx="3" stroke="var(--rtv-accent)" stroke-width="2"/>
                            <rect x="6" y="8" width="16" height="10" rx="1" fill="var(--rtv-accent)" opacity="0.2"/>
                            <line x1="10" y1="22" x2="18" y2="22" stroke="var(--rtv-accent)" stroke-width="2"/>
                            <line x1="8" y1="25" x2="20" y2="25" stroke="var(--rtv-muted)" stroke-width="1.5"/>
                            <circle cx="22" cy="8" r="1.5" fill="var(--rtv-danger)"/>
                        </svg>
                    </div>
                    <span class="font-display text-lg tracking-wide text-rtv-accent group-hover:text-rtv-accent2 transition-colors">
                        RealTV
                    </span>
                </a>

                <!-- Nav links -->
                <div class="flex items-center gap-1 sm:gap-2">
                    <a href="/setup"
                       class="nav-link {% if request.url.path.startswith('/setup') %}nav-active{% endif %}">
                        Setup
                    </a>
                    <a href="/shows"
                       class="nav-link {% if request.url.path.startswith('/shows') %}nav-active{% endif %}">
                        Shows
                        {% if request.state.show_count is defined and request.state.show_count > 0 %}
                        <span class="nav-badge">{{ request.state.show_count }}</span>
                        {% endif %}
                    </a>
                    <a href="/playlists"
                       class="nav-link {% if request.url.path.startswith('/playlists') %}nav-active{% endif %}">
                        Playlists
                        {% if request.state.playlist_count is defined and request.state.playlist_count > 0 %}
                        <span class="nav-badge">{{ request.state.playlist_count }}</span>
                        {% endif %}
                    </a>
                    <a href="/generate"
                       class="nav-link nav-generate {% if request.url.path.startswith('/generate') %}nav-active{% endif %}">
                        Generate
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 py-8">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="border-t border-rtv-border mt-auto py-4 text-center text-rtv-muted text-xs">
        <span class="opacity-60">plex-real-tv</span>
        <span class="mx-2 opacity-30">|</span>
        <span class="opacity-40">Simulate real TV on Plex</span>
    </footer>

    {% block scripts %}{% endblock %}
    <script>
    // Auto-dismiss toasts after 5 seconds
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.toast').forEach(function(toast) {
            setTimeout(function() {
                toast.style.transition = 'opacity 0.4s ease-out';
                toast.style.opacity = '0';
                setTimeout(function() { toast.remove(); }, 400);
            }, 5000);
        });
    });
    // Also handle dynamically-added toasts (htmx swaps)
    document.body.addEventListener('htmx:afterSwap', function() {
        document.querySelectorAll('.toast').forEach(function(toast) {
            if (toast.dataset.autoDismiss) return;
            toast.dataset.autoDismiss = 'true';
            setTimeout(function() {
                toast.style.transition = 'opacity 0.4s ease-out';
                toast.style.opacity = '0';
                setTimeout(function() { toast.remove(); }, 400);
            }, 5000);
        });
    });
    </script>
</body>
</html>